<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Charts</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="IMS Homework">
    <meta name="author" content="vancexu">
    <META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <script src="/static/js/jquery.js"></script>
    <script src="/static/js/highcharts.js" type="text/javascript"></script>
    <script src="/static/js/adapters/mootools-adapter.js" type="text/javascript"></script>
    <script src="/static/js/adapters/prototype-adapter.js" type="text/javascript"></script>

    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .modal-backdrop, .modal-backdrop.fade.in {
        z-index: 1000;
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">

    <script type="text/javascript">
      var chart1;
      var chart2;
      var chart3;
      var chart4;
      
      $(document).ready(function() {
        
        var options = {
          chart: {
            renderTo: 'chart3',
            type: 'column'
          },
          title: {
            text: 'Fruit Consumption'
          },
          xAxis: {
            categories: []
          },
          yAxis: {
            title: {
              text: 'Fruit eaten'
            }
          },
          series: []
        };
        $.get('/static/data/data.csv', function(data) {
          alert("in get 1");
          var lines = data.split('\n');
          $.each(lines, function(lineNo, line) {
            var items = line.split(',');
            if (lineNo == 0) {
              $.each(items, function(itemNo, item) {
                if (itemNo > 0) options.xAxis.categories.push(item);
              });
            }
            else {
              var series = {
                data: []
              };
              $.each(items, function(itemNo, item) {
                if(itemNo == 0) {
                  series.name = item;
                } else {
                  series.data.push(parseFloat(item));
                }
              });
              options.series.push(series);
            }
          });
          chart3 = new Highcharts.Chart(options);
        });


        var options2 = {
          chart: {
            renderTo: 'chart4',
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false
          },
          title: {
            text: 'All the customers gender proportion'
          },
          tooltip: {
            formatter: function() {
              return '<b>'+ this.point.name +'</b>: '+ this.percentage +' %';
            }
          },
          plotOptions: {
            pie: {
              allowPointSelect: true,
              cursor: 'pointer',
              dataLabels: {
                enabled: true,
                color: '#000000',
                connectorColor: '#000000',
                formatter: function() {
                  return '<b>'+ this.point.name +'</b>: '+ this.percentage +' %';
                }
              }
            }
          },
          // series: []
          series: [{
            type: 'pie',
            name: 'Browser share',
            data: [
              // ['Male',   45.0],
              // ['Female',   55.0],
              // {
              //   name: 'Female',
              //   y: 55.0,
              //   sliced: true,
              //   selected: true
              // }
            ]
          }]
        }; //pie
        $.get('/static/data/gender.csv', function(data) {
            var lines = data.split('\n');
            $.each(lines, function(lineNo, line) {
                var items = line.split(',');
                items[1] = parseFloat(items[1]);
                options2.series[0].data.push(items);
                // console.log(options2.series)
                // window.data = options2.series
                // options2.series[0].data.push(items);
                // var series = {
                //   type: 'pie',
                //   name: 'gender proportion',
                //   data: []
                // };
                // $.each(items, function(itemNo, item) {
                //     if (itemNo == 0) {
                //         options2.series[0].data.push(item);
                //     } else {
                //         options2.series[0].data.push(parseFloat(item));
                //     }
                // });
            });
            // console.log(options2.series[0]);
            // window.data = options2.series;
            // Create the chart
            chart4 = new Highcharts.Chart(options2);
        });



      }); //doc
    </script>

  </head>

  <body>
    
    <div class="container">
      <div id='chart1' style="width: 100%; height: 400px"></div>
      <div id='chart2' style="width: 100%; height: 400px"></div>
      <div id='chart3' style="width: 100%; height: 400px"></div>
      <div id='chart4' style="width: 100%; height: 400px"></div>

    </div>

    <!-- footer begin -->
    <hr />
    <div class="row">
      <div class="span4 offset6">
        <footer>
          <p>&copy; Software Institute of NJU 2012</p>
        </footer>
      </div>
    </div>
    <!-- footer end -->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/static/js/bootstrap.js"></script>
  </body>

</html>

  
